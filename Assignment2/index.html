<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phone Shop - Home</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
    <link rel="stylesheet" href="style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
    <div id="home-app">
        <nav>
            <div class="menu">
                <div class="logo-container">
                    <img src="image/logo.png" alt="Logo" class="logo">
                </div>
                <ul class="menu-content">
                    <li><a href="index.html" class="active"><span class="material-symbols-outlined">home</span><span>Home</span></a></li>
                    <li><a href="product.html"><span class="material-symbols-outlined">inventory_2</span><span>Product</span></a></li>
                    <li><a href="cart.html"><span class="material-symbols-outlined">shopping_cart</span><span>Cart</span></a></li>
                    <li><a href="purchase.html"><span class="material-symbols-outlined">receipt_long</span><span>Purchase</span></a></li>
                    <li><a href="account.html"><span class="material-symbols-outlined">person</span><span>Account</span></a></li>
                </ul>
            </div>
        </nav>

        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">Premium Smartphones</h1>
                <p class="hero-subtitle">Discover the latest mobile technology at unbeatable prices</p>
                <div>
                    <a href="product.html" class="hero-btn">
                        <i class='bx bx-shopping-bag'></i> Shop Now
                    </a>
                    <a href="#features" class="hero-btn hero-btn-outline">
                        <i class='bx bx-info-circle'></i> Learn More
                    </a>
                </div>
            </div>
        </section>

        <!-- Featured Products Section -->
        <section class="section-container">
            <div class="section-title">
                <i class='bx bx-star'></i>
                <h2>Featured Products</h2>
            </div>
            
            <div class="row" v-if="loading">
                <div class="col-12 text-center py-5">
                    <i class='bx bx-loader-alt bx-spin' style="font-size: 48px; color: #7494ec;"></i>
                    <p class="mt-3">Loading featured products...</p>
                </div>
            </div>
            
            <div class="row" v-else>
                <div v-for="product in featuredProducts" :key="product.id" class="col-md-6 col-lg-3 mb-4">
                    <div class="featured-product">
                        <div class="product-image">
                            <img :src="product.image" :alt="product.name">
                        </div>
                        <h3 class="product-name">{{ product.name }}</h3>
                        <div class="product-price">${{ product.price.toFixed(2) }}</div>
                        <button class="btn-view-product" @click="viewProductDetails(product)">
                            View Details
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-4">
                <a href="product.html" class="hero-btn">
                    <i class='bx bx-shopping-bag'></i> View All Products
                </a>
            </div>
        </section>

        <!-- About Section -->
        <section class="section-container">
            <div class="section-title">
                <i class='bx bx-info-circle'></i>
                <h2>About Us</h2>
            </div>
            
            <div class="row">
                <div class="col-lg-6 mb-4">
                    <div class="about-content">
                        <h3 class="about-title">The Leading Mobile Phone Shop</h3>
                        <p class="about-description">
                            Welcome to our premium smartphone store, where we bring you the latest and greatest in mobile technology. 
                            With over 10 years in the industry, we pride ourselves on offering a carefully curated selection of high-quality 
                            devices from top manufacturers around the world.
                        </p>
                        <p class="about-description">
                            Our team of experts tests each product thoroughly to ensure you get the best performance, 
                            reliability, and value for your money. Whether you're a tech enthusiast looking for cutting-edge features 
                            or a casual user seeking reliability and ease of use, we have the perfect smartphone for you.
                        </p>
                    </div>
                </div>
                
                <div class="col-lg-6 mb-4">
                    <div class="about-image">
                        <img src="image/store.jpg" alt="Our Store" onerror="this.src='https://placehold.co/600x400/333/7494ec?text=Our+Store'">
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="section-container">
            <div class="section-title">
                <i class='bx bx-badge-check'></i>
                <h2>Why Choose Us</h2>
            </div>
            
            <div class="row">
                <div class="col-md-6 col-lg-3 mb-4">
                    <div class="feature-card">
                        <i class='bx bx-check-shield feature-icon'></i>
                        <h3 class="feature-title">Quality Guarantee</h3>
                        <p class="feature-description">All our products come with a standard 1-year warranty and guaranteed authenticity.</p>
                    </div>
                </div>
                
                <div class="col-md-6 col-lg-3 mb-4">
                    <div class="feature-card">
                        <i class='bx bx-delivery feature-icon'></i>
                        <h3 class="feature-title">Free Shipping</h3>
                        <p class="feature-description">Enjoy free standard shipping on all orders with no minimum purchase required.</p>
                    </div>
                </div>
                
                <div class="col-md-6 col-lg-3 mb-4">
                    <div class="feature-card">
                        <i class='bx bx-support feature-icon'></i>
                        <h3 class="feature-title">24/7 Support</h3>
                        <p class="feature-description">Our customer service team is available around the clock to assist you.</p>
                    </div>
                </div>
                
                <div class="col-md-6 col-lg-3 mb-4">
                    <div class="feature-card">
                        <i class='bx bx-credit-card feature-icon'></i>
                        <h3 class="feature-title">Secure Payment</h3>
                        <p class="feature-description">Multiple payment options with advanced security measures to protect your data.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Toast Notification -->
        <div class="toast-container position-fixed bottom-0 end-0 p-3">
            <div id="homeToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
                <div class="toast-header">
                    <i class='bx bx-check-circle me-2 text-success' v-if="toastType === 'success'"></i>
                    <i class='bx bx-info-circle me-2 text-info' v-else-if="toastType === 'info'"></i>
                    <i class='bx bx-error me-2 text-warning' v-else-if="toastType === 'warning'"></i>
                    <i class='bx bx-x-circle me-2 text-danger' v-else-if="toastType === 'error'"></i>
                    <strong class="me-auto">{{ toastTitle }}</strong>
                    <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body">
                    {{ toastMessage }}
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Vue Home App
        const { createApp, ref, onMounted } = Vue;
        
        createApp({
            setup() {
                // State
                const featuredProducts = ref([]);
                const loading = ref(true);
                const email = ref('');
                const subscriptionMessage = ref('');
                const subscriptionSuccess = ref(false);
                const toastMessage = ref('');
                const toastTitle = ref('');
                const toastType = ref('success');
                let homeToast = null;
                
                // Methods
                const fetchFeaturedProducts = () => {
                    // Fetch products from phones.json in the data folder
                    fetch('data/phones.json')
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Network response was not ok');
                            }
                            return response.json();
                        })
                        .then(data => {
                            // Filter to get only featured products (if "featured" flag exists)
                            // Or take the first 4 products if no featured flag exists
                            const allProducts = Array.isArray(data.phones) ? data.phones : data;
                            
                            // Try to find featured products first
                            let featured = allProducts.filter(product => product.featured === true);
                            
                            // If no featured products found, take the first 4
                            if (featured.length === 0) {
                                featured = allProducts.slice(0, 4);
                            }
                            
                            // Set the featured products for display
                            featuredProducts.value = featured;
                            loading.value = false;
                        })
                        .catch(error => {
                            console.error('Error fetching products:', error);
                            // Fallback to some default products if fetch fails
                            featuredProducts.value = [
                                {
                                    id: 1,
                                    name: "iPhone 15 Pro",
                                    price: 1099.99,
                                    image: "image/iphone.jpg"
                                },
                                {
                                    id: 2,
                                    name: "Samsung Galaxy S23",
                                    price: 899.99,
                                    image: "image/samsung.jpg"
                                },
                                {
                                    id: 3,
                                    name: "Google Pixel 7",
                                    price: 799.99,
                                    image: "image/pixel.jpg"
                                },
                                {
                                    id: 4,
                                    name: "Xiaomi Mi 12",
                                    price: 699.99,
                                    image: "image/xiaomi.jpg"
                                }
                            ];
                            loading.value = false;
                            
                            // Show error toast
                            showToast('Error', 'Failed to load products. Showing default products instead.', 'error');
                        });
                };
                
                const subscribeNewsletter = () => {
                    // Simulate API call
                    subscriptionSuccess.value = true;
                    subscriptionMessage.value = "Thank you for subscribing to our newsletter!";
                    
                    // Show toast
                    showToast('Subscription Successful', 'You have successfully subscribed to our newsletter!', 'success');
                    
                    // Clear form
                    email.value = '';
                };
                
                const showToast = (title, message, type = 'success') => {
                    toastTitle.value = title;
                    toastMessage.value = message;
                    toastType.value = type;
                    
                    if (homeToast) {
                        homeToast.show();
                    }
                };
                
                const viewProductDetails = (product) => {
                    // Store the selected product in sessionStorage
                    sessionStorage.setItem('selectedProduct', JSON.stringify(product));
                    // Navigate to the product page with the id parameter
                    window.location.href = `product.html?id=${product.id}`;
                };
                
                // Lifecycle hooks
                onMounted(() => {
                    fetchFeaturedProducts();
                    
                    // Initialize Bootstrap toast
                    homeToast = new bootstrap.Toast(document.getElementById('homeToast'));
                    
                    // Check for user authentication
                    const userData = localStorage.getItem('currentUser');
                    if (userData) {
                        try {
                            const user = JSON.parse(userData);
                            // Welcome message for returning users
                            showToast('Welcome Back', `Hello, ${user.username}! Welcome back to our store.`, 'info');
                        } catch (e) {
                            console.error('Error parsing user data:', e);
                        }
                    }
                });
                
                // Return everything needed in the template
                return {
                    featuredProducts,
                    loading,
                    email,
                    subscriptionMessage,
                    subscriptionSuccess,
                    toastMessage,
                    toastTitle,
                    toastType,
                    subscribeNewsletter,
                    viewProductDetails
                };
            }
        }).mount('#home-app');
    </script>
</body>
</html>
